% arara: indent: {overwrite: yes, modifylinebreaks: yes}
% arara: pdflatex: {draft: yes, shell : yes}
% arara: bibtex
% arara: pdflatex: {draft: yes, shell : yes}
% arara: pdflatex: {shell : yes}
% arara: clean: { extensions: [ log ], files: [ indent ] }
% arara: clean: { extensions: [ aux, bak, log, toc, out ]}

\documentclass[12pt,a4paper]{article}


% Usepackages =============================================
% Standard et geometrie -----------------------------------
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage[margin=2cm]{geometry}

% Maths ---------------------------------------------------
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{mathtools,mathrsfs}

%Liens et dessins -----------------------------------------
\usepackage[colorlinks]{hyperref}
\usepackage{tikz}


% Couleurs ================================================
% definecolor ---------------------------------------------
\definecolor{coGB}{HTML}{1F77B4}
\definecolor{coOr}{HTML}{FF7F0E}
\definecolor{coWG}{HTML}{2CA02C}
\definecolor{coAR}{HTML}{D62728}
\definecolor{cMBP}{HTML}{9467BD}
\definecolor{coSM}{HTML}{8C564B}
\definecolor{coPP}{HTML}{E377C2}
\definecolor{coTG}{HTML}{7F7F7F}
\definecolor{coAG}{HTML}{BCBD22}
\definecolor{coBB}{HTML}{17BECF}
% hypersetup ----------------------------------------------
\hypersetup{
    colorlinks = True,
    linkcolor  = coAR,
    citecolor  = coWG,
    urlcolor   = coGB,
}


% Maths ===================================================
% mathbb --------------------------------------------------
\newcommand{\bbA}{\mathbb{A}}
\newcommand{\bbB}{\mathbb{B}}
\newcommand{\bbC}{\mathbb{C}}
\newcommand{\bbD}{\mathbb{D}}
\newcommand{\bbN}{\mathbb{N}}
\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbS}{\mathbb{S}}
\newcommand{\bbT}{\mathbb{T}}
\newcommand{\bbZ}{\mathbb{Z}}

% mathcal --------------------------------------------------
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calN}{\mathcal{N}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\calV}{\mathcal{V}}

% mathscr --------------------------------------------------
\newcommand{\scrC}{\mathscr{C}}

% mathrm --------------------------------------------------
\newcommand{\rmL}{\mathrm{L}}
\newcommand{\rmH}{\mathrm{H}}

% Constants -----------------------------------------------
\newcommand{\ex}{\mathsf{e}}
\newcommand{\im}{\mathsf{i}}

% Fontions ------------------------------------------------
\newcommand{\bJ}{\mathop{}\!\mathsf{J}}
\newcommand{\bY}{\mathop{}\!\mathsf{Y}}
\newcommand{\Hu}{\mathop{}\!\mathsf{H}^{(1)}}
\newcommand{\hu}{\mathop{}\!\mathsf{h}^{(1)}}
\newcommand{\Hd}{\mathop{}\!\mathsf{H}^{(2)}}
\newcommand{\bI}{\mathop{}\!\mathsf{I}}
\newcommand{\bK}{\mathop{}\!\mathsf{K}}
\newcommand{\outh}{\mathop{}\!\mathfrak{h}^{(1)}}

% Operateurs ----------------------------------------------
\newcommand{\di}[1]{\mathop{}\!\mathrm{d}#1}
\DeclareMathOperator{\OO}{\mathcal{O}}
\DeclareMathOperator{\oo}{\mathcal{\scriptstyle O}}
\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\Rot}{\mathbf{curl}}
\newcommand{\Ind}[1]{\mathop{}\!\mathbf{1}_{#1}}

% delimiters ----------------------------------------------
\newcommand{\plr}[1]{\left(#1\right)}
\newcommand{\clr}[1]{\left[#1\right]}
\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

% Vecteurs ------------------------------------------------
\newcommand{\vect}[1]{\boldsymbol{#1}}
\newcommand{\vx}{\boldsymbol{x}}

% Keywords ------------------------------------------------
\newcommand{\eps}{\varepsilon}
\newcommand{\comp}{\mathrm{comp}}
\newcommand{\loc}{\mathrm{loc}}
\newcommand{\inc}{\mathsf{in}}
\newcommand{\sca}{\mathsf{sc}}
\newcommand{\ecav}{\varepsilon_\mathsf{c}}
\newcommand{\mcav}{\mu_\mathsf{c}}


% Titre ===================================================
\title{claudius: analytic computations of scattering \\ \Large \emph{calculs analytiques pour la diffusion}}
\author{Zo√Øs \textsc{Moitier}}

%==========================================================
\begin{document}

\maketitle

\begin{abstract}
    We solve scattering problem for cases where we have analytical expressions.
    All cavities consider will be invariant by rotation.
    The shape consider are disk, annulus, ball and spherical shell where the permittivity and permeability are radial function.
\end{abstract}

\tableofcontents

%================================
\section{General settings}
%================================

We consider the scattering by spherical cavities, disk or annulus in dimension $2$, and ball or spherical shell in dimension $3$.
We call $\abs{\,\cdot\,}_d$ the euclidean norm in dimension $d = 2, 3$.
Disk and ball are denoted by $\bbB_\rho^d = \{\vx \in \bbR^d \mid \abs{\vx}_d < \rho\}$ for $\rho > 0$, and annulus and spherical shell are denoted by $\bbA_{\rho, \sigma}^d = \{\vx \in \bbR^d \mid \rho < \abs{\vx}_d < \sigma\}$ for $0 < \rho < \sigma$.
The cavities will be compose of concentric spherical shell with impenetrable or penetrable core and denoted by $\Omega$.
For a cavity with impenetrable core and $N \ge 0$ layers, we have $\Omega = \bbA_{\rho_1, \rho_2}^d \cup \bbA_{\rho_2, \rho_3}^d \cup \cdots \cup \bbA_{\rho_N, \rho_{N+1}}^d$ with $0 < \rho_1 < \rho_2 < \cdots < \rho_{N+1}$.
For a cavity with penetrable core and $N \ge 0$ layers, we have $\Omega = \bbB_{\rho_1}^d \cup \bbA_{\rho_1, \rho_2}^d \cup \cdots \cup \bbA_{\rho_N, \rho_{N+1}}^d$ with $0 = \rho_0 < \rho_1 < \cdots < \rho_{N+1}$.
The boundary/interfaces $\Gamma$ of the different layers of the cavity $\Omega$ is compose of concentric spheres $\Gamma = \rho_1\bbS^{d-1} \cup \rho_2\bbS^{d-1} \cup \cdots \cup \rho_N\bbS^{d-1}$.

\bigskip

We define the function $\eps \in \rmL^\infty(\bbR^d)$ and $\mu \in \rmL^\infty(\bbR^d)$ as
\[
    \eps(\vx) = \begin{dcases}
        \ecav\plr{\abs{\vx}_d} & \text{if } \vx \in \Omega\\
        1 & \text{otherwise}
    \end{dcases} \qquad
    \text{and} \qquad
    \mu(\vx) = \begin{dcases}
        \mcav\plr{\abs{\vx}_d} & \text{if } \vx \in \Omega\\
        1 & \text{otherwise}
    \end{dcases}
\]
where
\[
    \ecav = \sum_{n = 0}^{N} \eps_n \Ind{(\rho_n, \rho_{n+1})} \qquad
    \text{and} \qquad
    \mcav = \sum_{n = 0}^{N} \mu_n \Ind{(\rho_n, \rho_{n+1})}
\]
with $\eps_n, \mu_n \in \scrC^\infty([\rho_n, \rho_{n+1}], \bbR^*)$ for $0 \le n \le N$.
For the impenetrable case the index $n = 0$ is not use.
In some context the function can be view as the permittivity ($\eps$) and the permeability ($\mu$) of a material.

\bigskip

A positive wavenumber is noted $k$.
We only consider a plane wave incident field, we have $u^\inc : \vx \mapsto \exp(\im\, k\, \vect{\nu} \cdot \vx)$ with $\vect{\nu} \in \bbS^{d-1}$ the direction of the plane wave.
In the following, the scattered field is noted $u^\sca$ and the total field is noted $u$.

%================================
\section{Helmholtz's equation}
%================================

We consider the operator $u \mapsto -\mu^{-1}\Div(\eps^{-1}\, \nabla u)$ of domain
\[
    D^{d, \eps} \coloneqq \{u \in \rmL^2(\bbR^d) \mid \Div(\eps^{-1}\, \nabla u) \in \rmL^2(\bbR^d)\}
\]
and we define the ``locale'' version
\[
    D_\loc^{d, \eps} \coloneqq \{u \in \rmL_\loc^2(\bbR^d) \mid \forall \chi \in \scrC_\comp^\infty(\bbR^d),\ \chi u \in D^{d, \eps}\}.
\]

\bigskip

We define the following scattering problem: Given a wavenumber $k > 0$ and an incident field $u^\inc$, find the scattering field $u^\sca \in D_\loc^{d, \eps}$ such that the total field $u = u^\inc + u^\sca$ satisfy
\begin{equation}\label{eq:scat_pde_im}
    (\calD / \calN)\begin{dcases}
        -\mu^{-1}\Div\plr{\eps^{-1} \nabla u} - k^2 u = 0 & \text{in } \Omega \text{ and } \bbR^2 \setminus \overline{\Omega}\\[1ex]
        u = 0 \qquad \text{or} \qquad \partial_{\vect{n}}u = 0 & \text{on } \rho_1\bbS^{d-1}\\[1ex]
        \clr{u} = 0 \ \text{and}\ \clr{\eps^{-1} \partial_{\vect{n}} u} = 0 & \text{across } \rho_2\bbS^{d-1} \cup \cdots \cup \rho_N\bbS^{d-1}\\[1ex]
        \text{$u^\sca$ is $k$-outgoing} 
    \end{dcases}
\end{equation}
in the Dirichlet ($\calD$) or Neumann ($\calN$) case and
\begin{equation}\label{eq:scat_pde}
    (\calP)\begin{dcases}
        -\mu^{-1}\Div\plr{\eps^{-1} \nabla u} - k^2 u = 0 & \text{in } \Omega \text{ and } \bbR^2 \setminus \overline{\Omega}\\[1ex]
        \clr{u} = 0 \ \text{and}\ \clr{\eps^{-1} \partial_{\vect{n}} u} = 0 & \text{across } \rho_1\bbS^{d-1} \cup \cdots \cup \rho_N\bbS^{d-1}\\[1ex]
        \text{$u^\sca$ is $k$-outgoing} 
    \end{dcases}
\end{equation}
in the penetrable case, where $\vect{n} : \Gamma \to \bbS^{d-1}$ are the outward unit normal and $u^\sca$ is $k$-outgoing mean that for $|\vx| \ge \rho_N$, there exist $(g_m)_{m \in \bbN} \in \rmL^2(\bbS^{d-1})^{\bbN}$ such that
\begin{equation}\label{eq:OWC}
    u^\sca(\vx) = \sum_{m = 0}^{+\infty} \outh_m(k\, r)\, g_m(\omega)
\end{equation}
with $(r, \omega) \in \bbR_+ \times \bbS^{d-1}$ the spherical coordinate associated to the Cartesian coordinates $\vx \in \bbR^d$ and
\begin{equation}
    \outh_m(z) = \begin{dcases}
        \Hu_m(z) & \text{for } d = 2\\
        \hu_m(z) & \text{for } d = 3
    \end{dcases}
\end{equation}
with $z \mapsto \Hu_m(z)$ (resp.\ $z \mapsto \hu_m(z)$) is the cylindrical (resp.\ spherical) Hankel function of the first kind of order $m$.

%================================
\section{Maxwell's equation}
%================================

\appendix

%================================
\section{Bessel functions}
%================================

\[
    \hu_m(z) = \sqrt{\frac{\pi}{2z}} \Hu_{m+\frac{1}{2}}(z)
\]

%================================
\section{The scattering problems}
%================================



% = = = = = = = = = = = = = =
\subsection{1D reduction}
% = = = = = = = = = = = = = =

We look for solution of problem \eqref{prob:scattering} of the form
\[
    u(\vx) = \sum_{m \in \bbZ} w_m(r)\, \ex^{\im\, m\, \theta} \qquad
    \text{where } w_m(r) \coloneqq \frac{1}{2\pi} \int_0^{2\pi} u(r,\theta)\, \ex^{-\im\, m\, \theta} \di{\theta}.
\]
Similarly we write $u^\inc(\vx) = \sum_{m \in \bbZ} w_m^\inc(r)\, \ex^{\im\, m\, \theta}$ and $u^\sca(\vx) = \sum_{m \in \bbZ} w_m^\sca(r)\, \ex^{\im\, m\, \theta}$.
For the incident field, we have $w_m^\inc(r) = \bJ_m(k\, r)$ because the Jacobi-Anger expansion \cite[Eq.~10.12.1]{NIST:DLMF} states that
\begin{equation}\label{eq:JacobiAngerExpansion}
    u^\inc(\vx) = \ex^{\im k\, y} = \sum_{m \in \bbZ} \bJ_m(k\, r)\, \ex^{\im\, m\, \theta}
\end{equation}
where $z \mapsto \bJ_m(z)$ is the Bessel function of the first kind.
The series in equation \eqref{eq:JacobiAngerExpansion} converges absolutely on every compact set of $\bbR^2$.

The domain of the operator $w \mapsto -r^{-1}\, \mu^{-1} \partial_r(r\, \eps^{-1} \partial_r w) + m^2\, r^{-2}\, \eps^{-1}\mu^{-1} w$ and its ``loc'' version are define by
\begin{align*}
    \calD^{1, m} &\coloneqq \{w \in \rmL^2(\bbR_+^*, r\di{r}) \mid \partial_r(r\, \eps^{-1}\, \partial_r w) - m^2\, r^{-1}\eps^{-1} w \in \rmL^2(\bbR_+^*)\}\\
    \calD^{1, m}_\loc &\coloneqq \{w \in \rmL^2(\bbR_+^*, r\di{r}) \mid \forall \chi \in \scrC_\comp^\infty(\bbR),\ \chi w \in \calD^{1, m}\}.
\end{align*}

Problem \ref{prob:scattering} reduce to a family of problem index by $m \in \bbZ$: Given $k > 0$ find $w_m^\sca \in \calD^{1, m}_\loc$ such that $w_m = w_m^\inc + w_m^\sca$ and
\begin{equation}\label{prob:w_scattering}
     \begin{dcases}
        -\frac{1}{r\, \mu} \partial_r\plr{\frac{r}{\eps}\, \partial_r w_m} + \dfrac{m^2}{r^2\, \eps\mu} w_m - k^2\, w_m = 0 & \text{in } I \text{ and } \bbR^* \setminus \overline{I}      \\
        w_0'(0) = 0 & \text{on } \{0\}       \\
        \clr{w_m}_{\{1\}} = 0 \quad\text{and}\quad \clr{\eps^{-1}\, w_m'}_{\{1\}} = 0              & \text{across } \{1\}   \\
        w_m^\sca(r) \propto \Hu_m(k\, r)                                                              & r \ge 1
    \end{dcases}
\end{equation}
with $\propto$ meaning ``up to a multiplicative constant''.

%============================
\section{The resonances problem}
%============================

% = = = = = = = = = = = = = =
\subsection{Problem statement}
% = = = = = = = = = = = = = =

% = = = = = = = = = = = = = =
\subsection{1D reduction}
% = = = = = = = = = = = = = =

%============================
\section{Disk cavities with constant optical parameters}
%============================

\paragraph{Solution of the scattering problem.}
In this section, we assume that the cavity is the unit disk $\bbD$ and that $\ecav$ and $\mcav$ are non zero constant in $[0, 1]$.
The solution of problem \eqref{prob:w_scattering} for $0 < r < 1$ depend of the sign of $\ecav\mcav$.
We denote by $C_m$ the function
\[
    C_m(z) = \begin{dcases}
        \bJ_m(\sqrt{\ecav\mcav}\, z) & \text{if } \Re(\ecav\mcav) > 0\\
        \bI_m(\sqrt{-\ecav\mcav}\, z) & \text{if } \Re(\ecav\mcav) < 0
    \end{dcases}
\]
where $z \mapsto \bI_m(z)$ is the modified Bessel of the first kind.
The solution of problem \eqref{prob:w_scattering} is
\begin{equation}
    w_m(r) = \begin{dcases}
        a_m\, C_m(k\, r) & \text{if } r \le 1\\
        b_m\, \Hu_m(k\, r) + \bJ_m(k\, r) & \text{if } r > 1
    \end{dcases}
\end{equation}
where $(a_m, b_m)$ are solution of
\begin{equation}
    \begin{pmatrix*}[r]
        C_m(k) & -\Hu_m(k)\\[1ex]
        \ecav^{-1}\, C_m'(k) & -{\Hu_m}'(k)
    \end{pmatrix*}
    \begin{pmatrix}
        a_m\\[1ex]
        b_m
    \end{pmatrix} = 
    \begin{pmatrix}
        \bJ_m(k)\\[1ex]
        \bJ_m'(k)
    \end{pmatrix}.
\end{equation}


\paragraph{Solution of the resonance problem.}
A resonances $\ell$ is a complex satisfying
\begin{equation}
    \ecav^{-1}\, C_m'(\ell) \Hu_m(\ell) - C_m(\ell) {\Hu_m}'(\ell) = 0
\end{equation}
with the associated mode
\begin{equation}
    w_\ell(r) = \begin{dcases}
        C_m(k\, r) & \text{if } r \le 1\\
        \tfrac{C_m(k)}{\Hu_m(k)}\Hu_m(k\, r) & \text{if } r > 1
    \end{dcases}.
\end{equation}

%============================
\section{Annulus cavities}
%============================

\paragraph{Solution of the scattering problem.}
In this section, we assume that the cavity is the annulus $\bbA_\delta = \{\vx \in \bbR^2 \mid \delta < |\vx| < 1\}$ with $0 < \delta < 1$ and that $\ecav$ and $\mcav$ are non zero constant in $[0, 1]$.
The solution of problem \eqref{prob:w_scattering} for $\delta < r < 1$ depend of the sign of $\ecav\mcav$ and are denoted by $C_m$ and $D_m$.
The solution of problem \eqref{prob:w_scattering} is
\begin{equation}
    w_m(r) = \begin{dcases}
        a_m\, \bJ_m(k\, r) & \text{if } 0 \le r < \delta\\
        b_m\, C_m(k\, r) + c_m\, D_m(k\, r) & \text{if } \delta \le r \le 1\\
        d_m\, \Hu_m(k\, r) + \bJ_m(k\, r) & \text{if } r > 1
    \end{dcases}
\end{equation}
where $(a_m, b_m, c_m, d_m)$ are solution of
\begin{equation}
    \begin{pmatrix*}[r]
        -\bJ_m(k\delta) & C_m(k\delta) & D_m(k\delta) & 0\\[1ex]
        -\bJ_m'(k\delta) & \ecav^{-1}\, C_m'(k\delta) & \ecav^{-1}\, D_m'(k\delta) & 0\\[1ex]
        0 & C_m(k) & D_m(k) & -\Hu_m(k)\\[1ex]
        0 & \ecav^{-1}\, C_m'(k) & \ecav^{-1}\, D_m'(k) & -{\Hu_m}'(k)
    \end{pmatrix*}
    \begin{pmatrix}
        a_m\\[1ex]
        b_m\\[1ex]
        c_m\\[1ex]
        d_m
    \end{pmatrix} = 
    \begin{pmatrix}
        0\\[1ex]
        0\\[1ex]
        \bJ_m(k)\\[1ex]
        \bJ_m'(k)
    \end{pmatrix}.
\end{equation}


\paragraph{Solution of the resonance problem.}
A resonances $\ell$ is a complex satisfying
\begin{equation}
    \ecav^{-1}\, C_m'(\ell) \Hu_m(\ell) - C_m(\ell) {\Hu_m}'(\ell) = 0
\end{equation}
with the associated mode
\begin{equation}
    w_\ell(r) = \begin{dcases}
        C_m(k\, r) & \text{if } r \le 1\\
        \tfrac{C_m(k)}{\Hu_m(k)}\Hu_m(k\, r) & \text{if } r > 1
    \end{dcases}.
\end{equation}

% = = = = = = = = = = = = = =
\subsection{Constant optical parameters}
% = = = = = = = = = = = = = =

\[
    C_m(z) = \begin{dcases}
        \bJ_m(\sqrt{\ecav\mcav}\, z) & \text{if } \Re(\ecav\mcav) > 0\\
        \bI_m(\sqrt{-\ecav\mcav}\, z) & \text{if } \Re(\ecav\mcav) < 0
    \end{dcases} \quad
    \text{and} \quad
    D_m(z) = \begin{dcases}
        \bY_m(\sqrt{\ecav\mcav}\, z) & \text{if } \Re(\ecav\mcav) > 0\\
        \bK_m(\sqrt{-\ecav\mcav}\, z) & \text{if } \Re(\ecav\mcav) < 0
    \end{dcases}
\]
where $z \mapsto \bK_m(z)$ is the modified Bessel of the second kind.

% = = = = = = = = = = = = = =
\subsection{The flat well version}
% = = = = = = = = = = = = = =


\bibliographystyle{alpha}
\bibliography{references}

\end{document}
